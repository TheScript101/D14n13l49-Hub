-- fixed sonic

--[[
made by sammyc and loadlua
sonic by KillerDarkness0105

to fix movement not working on the other scripts, change
RealChar.Torso.CFrame = FakeCharacter.Torso.CFrame
to
RealChar.HumanoidRootPart.CFrame = FakeCharacter.Torso.CFrame
]]

print("Move list")
print("---------")
print("Shift = Boost")
print("Ctrl = Mach Speed Boost")
print("Q = Left QuickStep, E  = Right QuickStep")
print("C = Slide, in air to stomp")
print("Jump Then Hold B near a wall to wallrun")
print("M to change music, if you're standing still you'll do a special animation!")
print("Space near a wall to walljump, away from a wall homing attack")

local fake_transparency = 0.95 -- no ones really paying attention to the clientsided rig anyway


local Motors = {
	["Left Hip"] = 0,
	["Neck"] = 0,
	["Left Shoulder"] = 0,
	["Right Hip"] = 0,
	["Right Shoulder"] = 0
}


local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local RunService = game:GetService("RunService")
game.Players.LocalPlayer.Character.Archivable = true
local FakeCharacter = game.Players.LocalPlayer.Character:Clone()
Player.Character:BreakJoints()
Player.Character=nil

FELOADLIBRARY = {}
loadstring(game:GetObjects("rbxassetid://5209815302")[1].Source)()
local Create = FELOADLIBRARY.Create -- required to fix the create error

coroutine.wrap(function()

    wait(0.07)
    Player=game:GetService("Players").LocalPlayer
    Character=FakeCharacter
    PlayerGui=Player.PlayerGui
    Backpack=Player.Backpack
    Torso=Character.Torso
    Head=Character.Head
    Humanoid=Character.Humanoid
    LeftArm=Character["Left Arm"]
    LeftLeg=Character["Left Leg"]
    RightArm=Character["Right Arm"]
    RightLeg=Character["Right Leg"]
    LS=Torso["Left Shoulder"]
    LH=Torso["Left Hip"]
    RS=Torso["Right Shoulder"]
    RH=Torso["Right Hip"]
    Face = Head.face
    Neck=Torso.Neck
    it=Instance.new
    attacktype=1
    attacktype2=1
    vt=Vector3.new
    cf=CFrame.new
    cn=CFrame.new
    euler=CFrame.fromEulerAnglesXYZ
    angles=CFrame.Angles
    combo = 0
    necko=cf(0, 1, 0, -1, -0, -0, 0, 0, 1, 0, 1, 0)
    necko2=cf(0, -0.5, 0, -1, -0, -0, 0, 0, 1, 0, 1, 0)
    getgenv().LHC0=cf(-1,-1,0,-0,-0,-1,0,1,0,1,0,0)
    LHC1=cf(-0.5,1,0,-0,-0,-1,0,1,0,1,0,0)
    getgenv().RHC0=cf(1,-1,0,0,0,1,0,1,0,-1,-0,-0)
    RHC1=cf(0.5,1,0,0,0,1,0,1,0,-1,-0,-0)
    RootPart=Character.HumanoidRootPart
    RootJoint=RootPart.RootJoint
    RootCF=euler(-1.57,0,3.14)
    attack = false
    attackdebounce = false
    trispeed=.2
    attackmode='none'
    local idle=0
    local Anim="Idle"
    stance = false
    local ff = 2
    noleg = false
    evadecooldown = false
    equip = false
    local Effects = {}
    attackspeed = 0.14 
    df = false
    Swing = 1
    local sine = 0
    local change = 1
    local val = 0
    local speed = 0
    local rs = game:GetService("RunService").RenderStepped
    cam = workspace.CurrentCamera
    deb = game:GetService("Debris")
    Face.Transparency = 0
    --Face.Texture = "rbxassetid://176217905" --176217905
    Humanoid.WalkSpeed = 64
    local freefall = 0
    local headsunsound = RootPart:FindFirstChild("Running") or Instance.new("Sound",RootPart)
    headsunsound.SoundId = "rbxassetid://758199523"
    headsunsound.Volume = 2
    local boost = false
    Humanoid.JumpPower = 88
    local musicnum = 1
        
    local spd = Vector3.new(RootPart.Velocity.x,0,RootPart.Velocity.z).magnitude + 10
    local dir = Vector3.new(RootPart.Velocity.x,0,RootPart.Velocity.z).unit
    local GravPoint = RootPart.Velocity.y
    local NV = Vector3.new(0,0,0)

            music = Instance.new("Sound",RootPart)
            music.Volume = 1
            music.TimePosition = 0
            music.Pitch = 1
            music.SoundId = "rbxassetid://1251555494"
            music.Looped = true
            music:Play()
            

            boostsound = Instance.new("Sound",RootPart)
            boostsound.Volume = .6
            boostsound.TimePosition = 0
            boostsound.Pitch = 1
            boostsound.SoundId = "rbxassetid://924922553"
            boostsound.Looped = false



            stompsound = Instance.new("Sound",RootPart)
            stompsound.Volume = 2
            stompsound.TimePosition = 0
            stompsound.Pitch = 1
            stompsound.SoundId = "rbxassetid://1295424184"
            stompsound.Looped = false



            so = function(id,par,vol,pit)
            coroutine.resume(coroutine.create(function()
            local sou = Instance.new("Sound",par or workspace)
            sou.Volume=vol
            sou.Pitch=pit or 1
            sou.SoundId=id
            sou:play()
            game:GetService("Debris"):AddItem(sou,8)
            end))
            end
            
            --save shoulders
            RSH, LSH=nil, nil
            --welds
            RW, LW=Instance.new("Weld"), Instance.new("Weld")
            RW.Name="Right Shoulder" LW.Name="Left Shoulder"
            LH=Torso["Left Hip"]
            RH=Torso["Right Hip"]
            TorsoColor=Torso.BrickColor
            function NoOutline(Part)
            Part.TopSurface,Part.BottomSurface,Part.LeftSurface,Part.RightSurface,Part.FrontSurface,Part.BackSurface = 10,10,10,10,10,10
            end
            player=Player
            ch=Character
            RSH=ch.Torso["Right Shoulder"]
            LSH=ch.Torso["Left Shoulder"]
            --
            RSH.Parent=nil
            LSH.Parent=nil
            --
            RW.Name="Right Shoulder"
            RW.Part0=ch.Torso
            RW.C0=cf(1.5, 0.5, 0) --* CFrame.fromEulerAnglesXYZ(1.3, 0, -0.5)
            RW.C1=cf(0, 0.5, 0)
            RW.Part1=ch["Right Arm"]
            RW.Parent=ch.Torso
            --
            LW.Name="Left Shoulder"
            LW.Part0=ch.Torso
            LW.C0=cf(-1.5, 0.5, 0) --* CFrame.fromEulerAnglesXYZ(1.7, 0, 0.8)
            LW.C1=cf(0, 0.5, 0)
            LW.Part1=ch["Left Arm"]
            LW.Parent=ch.Torso
            
            
            newWeld = function(wp0, wp1, wc0x, wc0y, wc0z)
                local wld = Instance.new("Weld", wp1)
                wld.Part0 = wp0
                wld.Part1 = wp1
                wld.C0 = CFrame.new(wc0x, wc0y, wc0z)
            end
            local rs = game:GetService("RunService").RenderStepped
            
            newWeld(RootPart, Torso, 0, -1, 0)
            Torso.Weld.C1 = CFrame.new(0, -1, 0)
            newWeld(Torso, LeftLeg, -0.5, -1, 0)
            LeftLeg.Weld.C1 = CFrame.new(0, 1, 0)
            newWeld(Torso, RightLeg, 0.5, -1, 0)
            RightLeg.Weld.C1 = CFrame.new(0, 1, 0)
            
                Player=game:GetService('Players').LocalPlayer
                Character=FakeCharacter
                mouse=Player:GetMouse()
                m=Instance.new('Model',Character)
            
            
                local function weldBetween(a, b)
                    local weldd = Instance.new("ManualWeld")
                    weldd.Part0 = a
                    weldd.Part1 = b
                    weldd.C0 = CFrame.new()
                    weldd.C1 = b.CFrame:inverse() * a.CFrame
                    weldd.Parent = a
                    return weldd
                end
            
                ArtificialHB = Instance.new("BindableEvent", script)
            ArtificialHB.Name = "Heartbeat"
            
            script:WaitForChild("Heartbeat")
            
            frame = 1 / 80
            tf = 0
            allowframeloss = false
            tossremainder = false
            lastframe = tick()
            script.Heartbeat:Fire()
            game:GetService("RunService").Heartbeat:connect(function(s, p)
                tf = tf + s
                if tf >= frame then
                    if allowframeloss then
                        script.Heartbeat:Fire()
                        lastframe = tick()
                    else
                        for i = 1, math.floor(tf / frame) do
                            script.Heartbeat:Fire()
                        end
                        lastframe = tick()
                    end
                    if tossremainder then
                        tf = 0
                    else
                        tf = tf - frame * math.floor(tf / frame)
                    end
                end
            end)
            
    --[[]
            function swait(num)
                if num == 0 or num == nil then
                    ArtificialHB.Event:wait()
                else
                    for i = 0, num do
                        ArtificialHB.Event:wait()
                    end
                end
        end

        ]]
        



        function swait(num)
        if num == 0 or num == nil then
            game:service("RunService").Stepped:wait()
        else
            for i = 0, num do
                game:service("RunService").Stepped:wait()
            end
        end
    end

            function RemoveOutlines(part)
                part.TopSurface, part.BottomSurface, part.LeftSurface, part.RightSurface, part.FrontSurface, part.BackSurface = 10, 10, 10, 10, 10, 10
            end
            
            
            part = function(formfactor, parent, reflectance, transparency, brickcolor, name, size)
            local fp = it("Part")
            fp.formFactor = formfactor
            fp.Parent = parent
            fp.Reflectance = reflectance
            fp.Transparency = transparency
            fp.CanCollide = false
            fp.Locked = true
            fp.BrickColor = brickcolor
            fp.Name = name
            fp.Size = size
            fp.Position = Torso.Position
            NoOutline(fp)
            if fp.BrickColor == BrickColor.new("Dark indigo") then
                fp.Material = "Neon"
            else
                if fp.BrickColor == BrickColor.new("Really black") then
                fp.BrickColor = BrickColor.new("Really black")
                fp.Material = "Metal"
                else
                fp.Material = "Neon"
                end
            end
            fp:BreakJoints()
            return fp
            end
            
            mesh = function(Mesh, part, meshtype, meshid, offset, scale)
            local mesh = it(Mesh)
            mesh.Parent = part
            if Mesh == "SpecialMesh" then
                mesh.MeshType = meshtype
                mesh.MeshId = meshid
            end
            mesh.Offset = offset
            mesh.Scale = scale
            return mesh
            end
            
            weld = function(parent, part0, part1, c0)
            local weld = it("Weld")
            weld.Parent = parent
            weld.Part0 = part0
            weld.Part1 = part1
            weld.C0 = c0
            return weld
            end
            
            F1 = Instance.new("Folder", Character)
            F1.Name = "Effects Folder"
            F2 = Instance.new("Folder", F1)
            F2.Name = "Effects"
            Triangle = function(a, b, c)
            end
            
            MagicBlock = function(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
            local prt = part(3, F2, 0, 0, brickcolor, "Effect", vt())
            prt.Anchored = true
            prt.CanCollide = false
            prt.CFrame = cframe
            prt.Name = "prt"
            msh = mesh("BlockMesh", prt, "", "", vt(0, 0, 0), vt(x1, y1, z1))
            game:GetService("Debris"):AddItem(prt, 5)
            table.insert(Effects, {prt, "Block1", delay, x3, y3, z3})
            end
            
            
            
            MagicCircle = function(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
            local prt = part(3, F2, 0, 0, brickcolor, "Effect", vt())
            prt.Anchored = true
            prt.CanCollide = false
            prt.CFrame = cframe
            prt.Name = "prt"
            local msh = mesh("SpecialMesh", prt, "Sphere", "", vt(0, 0, 0), vt(x1, y1, z1))
            game:GetService("Debris"):AddItem(prt, 5)
            table.insert(Effects, {prt, "Cylinder", delay, x3, y3, z3})
            end
            
            MagicWave = function(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
            local prt = part(3, F2, 0, 0, brickcolor, "Effect", vt())
            prt.Anchored = true
            prt.CFrame = cframe
            local msh = mesh("SpecialMesh", prt, "FileMesh", "http://www.roblox.com/asset/?id=20329976", vt(0, 0, 0), vt(x1, y1, z1))
            game:GetService("Debris"):AddItem(prt, 5)
            table.insert(Effects, {prt, "Cylinder", delay, x3, y3, z3})
            end
            
            MagicCylinder = function(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
            local prt = part(3, F2, 0, 0, brickcolor, "Effect", vt(0.2, 0.2, 0.2))
            prt.Anchored = true
            prt.CFrame = cframe
            msh = mesh("SpecialMesh", prt, "Head", "", vt(0, 0, 0), vt(x1, y1, z1))
            game:GetService("Debris"):AddItem(prt, 5)
            Effects[#Effects + 1] = {prt, "Cylinder", delay, x3, y3, z3}
            end
            
            MagicCylinder2 = function(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
            local prt = part(3, F2, 0, 0, brickcolor, "Effect", vt(0.2, 0.2, 0.2))
            prt.Anchored = true
            prt.CFrame = cframe
            msh = mesh("CylinderMesh", prt, "", "", vt(0, 0, 0), vt(x1, y1, z1))
            game:GetService("Debris"):AddItem(prt, 5)
            Effects[#Effects + 1] = {prt, "Cylinder", delay, x3, y3, z3}
            end
            
            MagicBlood = function(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
            local prt = part(3, F2, 0, 0, brickcolor, "Effect", vt())
            prt.Anchored = true
            prt.CFrame = cframe
            local msh = mesh("SpecialMesh", prt, "Sphere", "", vt(0, 0, 0), vt(x1, y1, z1))
            game:GetService("Debris"):AddItem(prt, 5)
            table.insert(Effects, {prt, "Blood", delay, x3, y3, z3})
            end
            
            ElecEffect = function(cff, x, y, z)
            local prt = part(3, F2, 0, 0, BrickColor.new("Dark indigo"), "Part", vt(1, 1, 1))
            prt.Anchored = true
            prt.CFrame = cff * cf(math.random(-x, x), math.random(-y, y), math.random(-z, z))
            prt.CFrame = cf(prt.Position)
            game:GetService("Debris"):AddItem(prt, 2)
            xval = math.random() / 2
            yval = math.random() / 2
            zval = math.random() / 2
            msh = mesh("BlockMesh", prt, "", "", vt(0, 0, 0), vt(xval, yval, zval))
            Effects[#Effects + 1] = {prt, "Elec", 0.1, x, y, z, xval, yval, zval}
            end
            
            function FindNearestTorso(Position, Distance, SinglePlayer)
                if SinglePlayer then
                    return (SinglePlayer.Torso.CFrame.p - Position).magnitude < Distance
                end
                local List = {}
                for i, v in pairs(workspace:GetChildren()) do
                    if v:IsA("Model") then
                        if v:findFirstChild("Torso") then
                            if v ~= Character then
                                if (v.Torso.Position - Position).magnitude <= Distance then
                                    table.insert(List, v)
                                end 
                            end 
                        end 
                    end 
                end
                return List
            end
            
            
            function CreatePart(Parent, Material, Reflectance, Transparency, BColor, Name, Size)
        local Part = Create("Part"){
            Parent = Parent,
            Reflectance = Reflectance,
            Transparency = Transparency,
            CanCollide = false,
            Locked = true,
            BrickColor = BrickColor.new(tostring(BColor)),
            Name = Name,
            Size = Size,
            Material = Material,
        }
        RemoveOutlines(Part)
        return Part
    end
        
    function CreateMesh(Mesh, Part, MeshType, MeshId, OffSet, Scale)
        local Msh = Create(Mesh){
            Parent = Part,
            Offset = OffSet,
            Scale = Scale,
        }
        if Mesh == "SpecialMesh" then
            Msh.MeshType = MeshType
            Msh.MeshId = MeshId
        end
        return Msh
    end
            
            
            
    function BlockEffect(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay, Type)
        local prt = CreatePart(workspace, "Neon", 0, 0, brickcolor, "Effect", Vector3.new())
        prt.Anchored = true
        prt.CFrame = cframe
        local msh = CreateMesh("BlockMesh", prt, "", "", Vector3.new(0, 0, 0), Vector3.new(x1, y1, z1))
        game:GetService("Debris"):AddItem(prt, 10)
        if Type == 1 or Type == nil then
            table.insert(Effects, {
                prt,
                "Block1",
                delay,
                x3,
                y3,
                z3,
                msh
            })
        elseif Type == 2 then
            table.insert(Effects, {
                prt,
                "Block2",
                delay,
                x3,
                y3,
                z3,
                msh
            })
        end
    end

    function SphereEffect(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
        local prt = CreatePart(workspace, "Neon", 0, 0, brickcolor, "Effect", Vector3.new())
        prt.Anchored = true
        prt.CFrame = cframe
        local msh = CreateMesh("SpecialMesh", prt, "Sphere", "", Vector3.new(0, 0, 0), Vector3.new(x1, y1, z1))
        game:GetService("Debris"):AddItem(prt, 10)
        table.insert(Effects, {
            prt,
            "Cylinder",
            delay,
            x3,
            y3,
            z3,
            msh
        })
    end

    function RingEffect(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay,material)
    local prt=CreatePart(workspace,material,0,0,brickcolor,"Effect",vt(.5,.5,.5))--part(3,workspace,"SmoothPlastic",0,0,brickcolor,"Effect",vt(0.5,0.5,0.5))
    prt.Anchored=true
    prt.CFrame=cframe
    msh=CreateMesh("SpecialMesh",prt,"FileMesh","http://www.roblox.com/asset/?id=3270017",vt(0,0,0),vt(x1,y1,z1))
    game:GetService("Debris"):AddItem(prt,2)
    coroutine.resume(coroutine.create(function(Part,Mesh,num) 
    for i=0,1,delay do
    swait()
    Part.Transparency=i
    Mesh.Scale=Mesh.Scale+vt(x3,y3,z3)
    end
    Part.Parent=nil
    end),prt,msh,(math.random(0,1)+math.random())/5)
    end

    function CylinderEffect(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
        local prt = CreatePart(workspace, "SmoothPlastic", 0, 0, brickcolor, "Effect", Vector3.new())
        prt.Anchored = true
        prt.CFrame = cframe
        local msh = CreateMesh("CylinderMesh", prt, "", "", Vector3.new(0, 0, 0), Vector3.new(x1, y1, z1))
        game:GetService("Debris"):AddItem(prt, 10)
        table.insert(Effects, {
            prt,
            "Cylinder",
            delay,
            x3,
            y3,
            z3,
            msh
        })
    end

    function WaveEffect(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
        local prt = CreatePart(workspace, "Neon", 0, 0, brickcolor, "Effect", Vector3.new())
        prt.Anchored = true
        prt.CFrame = cframe
        local msh = CreateMesh("SpecialMesh", prt, "FileMesh", "rbxassetid://20329976", Vector3.new(0, 0, 0), Vector3.new(x1, y1, z1))
        game:GetService("Debris"):AddItem(prt, 10)
        table.insert(Effects, {
            prt,
            "Cylinder",
            delay,
            x3,
            y3,
            z3,
            msh
        })
    end

    function SpecialEffect(brickcolor, cframe, x1, y1, z1, x3, y3, z3, delay)
        local prt = CreatePart(workspace, "Neon", 0, 0, brickcolor, "Effect", Vector3.new())
        prt.Anchored = true
        prt.CFrame = cframe
        local msh = CreateMesh("SpecialMesh", 
